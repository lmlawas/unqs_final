total bytes in flowsv4 = 287174218403


select IP_SRC_ADDR,
IP_DST_ADDR,
SUM(IN_BYTES+OUT_BYTES) TOTAL_BYTES,
ROUND(TOTAL_BYTES/287174218403*100, 1)
from flowsv4
group by IP_SRC_ADDR, IP_DST_ADDR
order by TOTAL_BYTES asc;

|  1249732170 |   167781522 |   718842556 |                                                0.3 |
|  1249732200 |   167781522 |   721540725 |                                                0.3 |
|  3393567215 |   167772433 |   721653198 |                                                0.3 |
|  1249733143 |   167781522 |   733019792 |                                                0.3 |
|   167783736 |  1249732215 |   736956074 |                                                0.3 |
|  1249708652 |   167781522 |   759930020 |                                                0.3 |
|  2915187544 |   167781522 |   767059968 |                                                0.3 |
|  1249708633 |   167781522 |   768274852 |                                                0.3 |
|  3114495883 |   167785720 |   774416904 |                                                0.3 |
|  1211399467 |   167785895 |   830116860 |                                                0.3 |
|  2915187564 |   167781522 |   836511918 |                                                0.3 |
|  3393565714 |   167772502 |   840458163 |                                                0.3 |
|  3627731713 |   167781426 |   861948984 |                                                0.3 |
|  2915187545 |   167781522 |   878132458 |                                                0.3 |
|  3114495351 |   167785720 |   895276790 |                                                0.3 |
|  1249708636 |   167781522 |   916201650 |                                                0.3 |
|   167787564 |  3393567212 |   925291206 |                                                0.3 |
|  3393567212 |   167824779 |   936289916 |                                                0.3 |
|  1759370558 |   167784059 |   945290234 |                                                0.3 |
|  2915187532 |   167781522 |   951239400 |                                                0.3 |
|  3393567217 |   167824779 |  1002985488 |                                                0.3 |21
|   167774332 |  3627731726 |  1039431952 |                                                0.4 |
|   167782193 |   301815244 |  1054547100 |                                                0.4 |
|  1249732171 |   167781522 |  1068814836 |                                                0.4 |
|   225117234 |   167775208 |  1099282753 |                                                0.4 |
|   400000810 |   167775960 |  1170926676 |                                                0.4 |
|  3105216672 |   167785541 |  1210844724 |                                                0.4 |
|   167783254 |  3627731727 |  1242563600 |                                                0.4 |
|  3393566988 |   167824779 |  1259137034 |                                                0.4 |8
|   225117234 |   167778372 |  1392240560 |                                                0.5 |
|   301814731 |   167778372 |  1490640032 |                                                0.5 |
|  3232235777 |  4026531834 |  1562493373 |                                                0.5 |
|  3232235521 |  4026531834 |  1575146908 |                                                0.5 |4
|    96753026 |   167781522 |  1611849447 |                                                0.6 |
|  2915187515 |   167781522 |  1630481316 |                                                0.6 |
|  3627736449 |   167772855 |  1750693948 |                                                0.6 |
|  3393565714 |   167776468 |  1812641471 |                                                0.6 |4
|  3111686621 |   167777984 |  2098695101 |                                                0.7 |1
|  3393566991 |   167824779 |  2154908552 |                                                0.8 |
|  3114495383 |   167782547 |  2187777140 |                                                0.8 |2
|   167781195 |  2649753392 |  2771346197 |                                                1.0 |
|  3627736449 |   167783472 |  2815063488 |                                                1.0 |
|   167783740 |  3627736462 |  2920460978 |                                                1.0 |3
|  1844203949 |   167778372 |  3426880570 |                                                1.2 |1
|   167798008 |  4010412554 |  9173263420 |                                                3.2 |1
|  3627736449 |   167781426 | 23393060326 |                                                8.1 |1
|   167782102 |  1788788301 | 62409079786 |                                               21.7 |1
|  1788788301 |   167782102 | 79135454093 |                                               27.6 |1

81%



167772160-184549375	    
2886729728-2887778303
3232235520-3232301055

select IP_SRC_ADDR src,
IP_DST_ADDR dst,
SUM(IN_BYTES+OUT_BYTES) total_bytes,
ROUND(SUM(IN_BYTES+OUT_BYTES)/102982614457*100, 1) percent_bytes
from flowsv4
where IP_DST_ADDR NOT IN (select IP_DST_ADDR from local_ip_addr)
group by src, dst order by SUM(IN_BYTES+OUT_BYTES) asc;

total out flow rows
58831

out flow bytes
102982614457



\begin{table}[]
\centering
\caption{\textbf{Top 9 Out-Flows}}
\label{top-out-flows}
\begin{tabular}{|l|l|l|l|}
\hline
\textbf{IP SOURCE ADDRESS} & \textbf{IP DESTINATION ADDRESS} 	& \textbf{TOTAL BYTES} 	& \textbf{\%} \\ \hline
    10.0.38.214		       & 106.158.190.77 (KDDI CORPORATION)  &  62409079786			& 60.6        \\ \hline
    10.0.100.248           & 239.10.10.10 (MULTICAST)			&  9173263420           & 8.9         \\ \hline
    10.0.45.60      	   & 216.58.221.142 (Google LLC)		&  2920460978           & 2.8         \\ \hline
    10.0.35.75             & 157.240.7.48 (Facebook, Inc.)		&  2771346197           & 2.7         \\ \hline
    192.168.0.1            & 239.255.255.250 (MULTICAST)		&  1575146908           & 1.5         \\ \hline
    192.168.1.1            & 239.255.255.250 (MULTICAST)		&  1562493373           & 1.5         \\ \hline
    10.0.43.86             & 216.58.203.15 (Google LLC)			&  1242563600           & 1.2         \\ \hline
    10.0.39.49		   	   & 17.253.85.204 (Apple Inc.)			&  1054547100           & 1.0         \\ \hline
    10.0.8.124	           & 216.58.203.14 (Google LLC)			&  1039431952           & 1.0         \\ \hline
\end{tabular}
\end{table}

10.0.2.183
10.0.16.212
10.0.22.192
10.0.205.139
10.0.40.147
10.0.44.48
10.0.24.68
10.0.36.50
10.0.38.214
OUT

|  167774332 | 3627731726 |  1039431952 |           1.0 |		216.58.203.14 = AS15169 Google LLC
|  167782193 |  301815244 |  1054547100 |           1.0 |		17.253.85.204 = AS6185 Apple Inc.
|  167783254 | 3627731727 |  1242563600 |           1.2 |		216.58.203.15 = AS15169 Google LLC
| 3232235777 | 4026531834 |  1562493373 |           1.5 |		239.255.255.250 = MULTICAST
| 3232235521 | 4026531834 |  1575146908 |           1.5 |		239.255.255.250 = MULTICAST
|  167781195 | 2649753392 |  2771346197 |           2.7 |		157.240.7.48 = AS32934 Facebook, Inc.
|  167783740 | 3627736462 |  2920460978 |           2.8 |		216.58.221.142 = AS15169 Google LLC
|  167798008 | 4010412554 |  9173263420 |           8.9 |		239.10.10.10 = MULTICAST
|  167782102 | 1788788301 | 62409079786 |          60.6 |		106.158.190.77 = AS2516 KDDI CORPORATION

81.2%


KDDI Corporation is a telecommunications business based in Japan. It provides content hosting over optimized networks, and ICT and business services and solutions.
http://www.kddi.com/english/corporate/kddi/our-business/ may 28 2018

Google LLC is an American multinational technology company that specializes in Internet-related services and products, which include online advertising technologies, search engine, cloud computing, software, and hardware. 

WorldStream B.V. is a popular Internet Service Provider in the Netherlands used by customers from all over the world. It provides cost-effective services to secure hosting environment, and hardware and Operating System technologies.
https://www.worldstream.nl/en/about/company

M247 Ltd. is a UK-based technology company that offers  services and tools to secure network and data while providing connectivity and internet infastructure that expands to a global scale.
https://m247.com/about-us/

Converge ICT is a Philippine technology company with the fastest growing fiber internet and offers services to ensure pure end-to-end fiber internet connection, thus reducing data loss, faster speed and bandwidth.
http://www.convergeict.com/about-us/

Facebook is an American online social media and social networking service company.

Apple Inc. is an American multinational technology company that designs, develops, and sells consumer electronics, computer software, and online services.

Multicast
https://tools.ietf.org/html/rfc1112

total in flow rows
22058

in flow bytes
184191603946

| 3627736449 |  167772855 |  1750693948 |           1.0 |		216.58.221.129 = AS15169 Google LLC
| 3393565714 |  167776468 |  1812641471 |           1.0 |		202.69.180.18 = AS17639 Converge ICT Solutions Inc.
| 3111686621 |  167777984 |  2098695101 |           1.1 |		185.120.145.221 = AS9009 M247 Ltd
| 3393566991 |  167824779 |  2154908552 |           1.2 |		202.69.185.15 = AS17639 Converge ICT Solutions Inc.
| 3114495383 |  167782547 |  2187777140 |           1.2 |		185.163.109.151 = AS9009 M247 Ltd
| 3627736449 |  167783472 |  2815063488 |           1.5 |		216.58.221.129 = AS15169 Google LLC
| 1844203949 |  167778372 |  3426880570 |           1.9 |		109.236.81.173 = AS49981 WorldStream B.V.
| 3627736449 |  167781426 | 23393060326 |          12.7 |		216.58.221.129 = AS15169 Google LLC
| 1788788301 |  167782102 | 79135454093 |          43.0 |		106.158.190.77 = AS2516 KDDI CORPORATION


\begin{table}[]
\centering
\caption{\textbf{Top 9 In-Flows}}
\label{top-out-flows}
\begin{tabular}{|l|l|l|l|}
\hline
\textbf{IP SOURCE ADDRESS} 						& \textbf{IP DESTINATION ADDRESS}	& \textbf{TOTAL BYTES} 	& \textbf{\%} \\ \hline
    106.158.190.77 (KDDI CORPORATION)			& 10.0.38.214						&  79135454093			& 43.0        \\ \hline
    216.58.221.129 (Google LLC)					& 10.0.36.50						&  23393060326          & 12.7        \\ \hline
    109.236.81.173 (WorldStream B.V.)			& 10.0.24.68						&  3426880570           & 1.9         \\ \hline
    216.58.221.129 (Google LLC)					& 10.0.44.48						&  2815063488           & 1.5         \\ \hline
    185.163.109.151 (M247 Ltd)					& 10.0.40.147						&  2187777140           & 1.2         \\ \hline
    202.69.185.15 (Converge ICT Solutions Inc.)	& 10.0.205.139						&  2154908552			& 1.2         \\ \hline
    185.120.145.221 (M247 Ltd)					& 10.0.22.192						&  2098695101           & 1.1         \\ \hline
    202.69.180.18 (Converge ICT Solutions Inc.)	& 10.0.16.212						&  1812641471           & 1.0         \\ \hline
    216.58.221.129 (Google LLC)					& 10.0.2.183						&  1750693948           & 1.0         \\ \hline
\end{tabular}
\end{table}


select IP_SRC_ADDR src,
IP_DST_ADDR dst,
SUM(IN_BYTES+OUT_BYTES) total_bytes,
ROUND(SUM(IN_BYTES+OUT_BYTES)/184191603946*100, 1) percent_bytes
from flowsv4
where IP_DST_ADDR IN (select IP_DST_ADDR from local_ip_addr)
group by src, dst order by SUM(IN_BYTES+OUT_BYTES) asc;

64.6%

total flow bytes
287174218403











select IP_DST_ADDR dst, 
ROUND(SUM(IN_BYTES+OUT_BYTES)/102982614457*100, 1) pct_out
from flowsv4 where IP_DST_ADDR not in (select distinct IP_DST_ADDR from flowsv4 where IP_DST_ADDR between 167772160 and 184549375 UNION select distinct IP_DST_ADDR from flowsv4 where IP_DST_ADDR between 2886729728 and 2887778303 UNION select distinct IP_DST_ADDR from flowsv4 where IP_DST_ADDR between 3232235520 and 3232301055) group by IP_DST_ADDR order by SUM(IN_BYTES+OUT_BYTES) asc



total flows 554392

select DISTINCT L4_DST_PORT,
count(idx),
round((count(idx)/554392)*100, 1)
from flowsv4
group by L4_DST_PORT
order by count(idx) asc;

|        1302 |        292 |                               0.1 |
|       51369 |        295 |                               0.1 |
|          23 |        300 |                               0.1 |
|       50701 |        326 |                               0.1 |
|          68 |        378 |                               0.1 |
|       60312 |        478 |                               0.1 |
|       54836 |        480 |                               0.1 |
|       19302 |        526 |                               0.1 |
|       35185 |        544 |                               0.1 |
|       30647 |        551 |                               0.1 |
|       14462 |        573 |                               0.1 |
|       14016 |        574 |                               0.1 |
|       46108 |        575 |                               0.1 |
|       14268 |        575 |                               0.1 |
|       53805 |        577 |                               0.1 |
|       41022 |        583 |                               0.1 |
|       11943 |        617 |                               0.1 |
|       51880 |        619 |                               0.1 |
|        5938 |        628 |                               0.1 |
|       14332 |        629 |                               0.1 |
|       38792 |        699 |                               0.1 |
|        4070 |        712 |                               0.1 |
|        8765 |        748 |                               0.1 |
|       41235 |        811 |                               0.1 |
|       45516 |        824 |                               0.1 |25
|        4370 |        854 |                               0.2 |
|       54675 |        857 |                               0.2 |
|       56475 |        875 |                               0.2 |
|         162 |        890 |                               0.2 |
|       57621 |        908 |                               0.2 |
|       45560 |       1202 |                               0.2 |
|        3702 |       1310 |                               0.2 |7
|       14666 |       1387 |                               0.3 |
|       42470 |       1395 |                               0.3 |
|       54061 |       1410 |                               0.3 |
|       22222 |       1411 |                               0.3 |
|        8004 |       1421 |                               0.3 |
|         138 |       1520 |                               0.3 |
|        3478 |       1564 |                               0.3 |
|        5222 |       1840 |                               0.3 |8
|        5353 |       2428 |                               0.4 |1
|        9993 |       2556 |                               0.5 |1
|       17500 |       3694 |                               0.7 |
|        3052 |       4148 |                               0.7 |2
|       14021 |       4258 |                               0.8 |
|         137 |       4460 |                               0.8 |
|        3544 |       4580 |                               0.8 |3
|        5228 |       5836 |                               1.1 |1
|         123 |       8430 |                               1.5 |1

|          67 |       8602 |   1.6 |  	| 	Bootstrap Protocol Server
|         161 |       9142 |   1.6 |2 	| 	SNMP
|        7437 |      13734 |   2.5 |1	| 	Faximum
|           0 |      15732 |   2.8 |1	| 	Reserved
|        5355 |      17090 |   3.1 |1	| 	LLMNR
|          80 |      18485 |   3.3 |1	| 	HTTP
|         445 |      28746 |   5.2 |1	|	Microsoft-DS
|        5060 |      43101 |   7.8 |1	| 	SIP
|        1900 |      52579 |   9.5 |1	| 	SSDP
|          53 |      60765 |  11.0 |1	| 	DNS
|         443 |      65088 |  11.7 |1	| 	HTTPS

73.26%

\begin{table*}[ht]
\centering
\caption{\textbf{Top 9 In-Flows}}
\label{top-out-flows}
\begin{tabular}{|l|l|l|l|}
\hline
\textbf{L4 DESTINATION PORT}			& \textbf{PROTOCOL}			& \textbf{TOTAL FLOWS}		& \textbf{\%} 	 \\ \hline
    443									& HTTPS						&  65088					& 11.7  	     \\ \hline
    53									& DNS						&  60765        			& 11.0			 \\ \hline
    1900								& SSDP						&  52579					& 9.5			 \\ \hline
    5060								& SIP						&  43101          			& 7.8   	     \\ \hline
    445									& Microsoft-DS				&  28746           			& 5.2        	 \\ \hline
    80									& HTTP						&  18485					& 3.3         	 \\ \hline
    5355								& LLMNR						&  17090    		        & 3.1    	     \\ \hline
    0									& Reserved					&  15732		            & 2.8       	 \\ \hline
    7437								& Faximum					&  13734        		    & 2.5         	 \\ \hline
    161									& SNMP						&  9142        			    & 1.6         	 \\ \hline
    67									& Bootstrap Protocol Server	&  8602        			    & 1.6         	 \\ \hline
\end{tabular}
\end{table*}

Hypertext Transfer Protocol Secure - secure communication  via encryption over a computer network.

Domain Name System - match names to IP addresses and vice versa

Simple Service Discovery Protocol - advertisement and discovery of network services and presence information

Session Inititation Protocol - signal and control multimedia communication sessions in applications using Internet telephony for voice and video calls, private IP telephone systems, and even instant messaging over IP networks. It is part of the Voice over IP (VoIP) group of technologies.

Microsoft-Directory Services - follows the Server Message Block protocol for shared access to files, printers, and serial ports and ohter communications between nodes on a network.

Hypertext Transfer Protocol - used to facilitate data communication for the World Wide Web

Link Local Multicast Name Resolution - based on DNS and allows both IPv4 and IPv6 hosts to perform name resolution for hosts on the same local link.s

0 (Reserved) and 7437 (Faximum) are likely ports used to send computer attacks and harmful content like viruses.

Simple Network Management Protocol - collect and organize information about managed devices on IP networks and for modifying information to change device behavior

Bootstrap Protocol Server - exclusive for IPv4, Dynamic Host Configuration Protocol (DHCP) server to receive requests

select DISTINCT L4_SRC_PORT,
count(idx),
round((count(idx)/554392)*100, 1)
from flowsv4
group by L4_SRC_PORT
order by count(idx) asc;

|       38909 |        278 |                               0.1 |
|        1302 |        292 |                               0.1 |
|       51369 |        300 |                               0.1 |
|       56943 |        318 |                               0.1 |
|       50701 |        331 |                               0.1 |
|       40411 |        334 |                               0.1 |
|       19302 |        358 |                               0.1 |
|       61411 |        414 |                               0.1 |
|        4370 |        427 |                               0.1 |
|          67 |        451 |                               0.1 |
|       65497 |        463 |                               0.1 |
|       14268 |        468 |                               0.1 |
|        8765 |        483 |                               0.1 |
|       57353 |        498 |                               0.1 |
|        5938 |        508 |                               0.1 |
|       36595 |        526 |                               0.1 |
|       14462 |        543 |                               0.1 |
|       48984 |        562 |                               0.1 |
|       48673 |        567 |                               0.1 |
|       46903 |        569 |                               0.1 |
|       45481 |        570 |                               0.1 |
|       35002 |        572 |                               0.1 |
|       56832 |        574 |                               0.1 |
|       47792 |        574 |                               0.1 |
|       14016 |        574 |                               0.1 |
|       54267 |        575 |                               0.1 |
|       35185 |        575 |                               0.1 |
|       51841 |        575 |                               0.1 |
|       52193 |        576 |                               0.1 |
|       46108 |        576 |                               0.1 |
|       44948 |        579 |                               0.1 |
|       47766 |        580 |                               0.1 |
|       41127 |        581 |                               0.1 |
|       41022 |        582 |                               0.1 |
|       40149 |        582 |                               0.1 |
|       53880 |        582 |                               0.1 |
|       53985 |        582 |                               0.1 |
|       60312 |        582 |                               0.1 |
|       42318 |        583 |                               0.1 |
|       54836 |        583 |                               0.1 |
|       53805 |        583 |                               0.1 |
|       60019 |        584 |                               0.1 |
|       60367 |        585 |                               0.1 |
|       11943 |        617 |                               0.1 |
|       51880 |        627 |                               0.1 |
|       47153 |        631 |                               0.1 |
|       53235 |        635 |                               0.1 |
|       41737 |        667 |                               0.1 |
|       45560 |        697 |                               0.1 |
|       34589 |        742 |                               0.1 |
|       42456 |        802 |                               0.1 |
|       38792 |        804 |                               0.1 |
|       41235 |        812 |                               0.1 |
|        4070 |        813 |                               0.1 |
|       46285 |        816 |                               0.1 |
|       45516 |        816 |                               0.1 |
|       56475 |        881 |                               0.2 |
|         162 |        889 |                               0.2 |
|       57621 |        908 |                               0.2 |
|       36804 |       1077 |                               0.2 |
|        5222 |       1094 |                               0.2 |
|       37173 |       1156 |                               0.2 |
|        3478 |       1211 |                               0.2 |
|       45977 |       1279 |                               0.2 |
|        2049 |       1290 |                               0.2 |
|        5061 |       1382 |                               0.2 |
|       14666 |       1396 |                               0.3 |
|       54061 |       1421 |                               0.3 |
|       35196 |       1439 |                               0.3 |
|       49156 |       1439 |                               0.3 |
|       46503 |       1440 |                               0.3 |
|       42047 |       1456 |                               0.3 |
|       49153 |       1471 |                               0.3 |
|       39200 |       1473 |                               0.3 |
|         138 |       1484 |                               0.3 |
|       53707 |       1521 |                               0.3 |
|        5228 |       1714 |                               0.3 |
|         161 |       1771 |                               0.3 |
|       51092 |       2053 |                               0.4 |
|       42470 |       2064 |                               0.4 |
|        5353 |       2368 |                               0.4 |
|        1025 |       2902 |                               0.5 |
|        3544 |       3022 |                               0.5 |
|        9993 |       3241 |                               0.6 |
|       14021 |       3589 |                               0.6 |
|         137 |       3689 |                               0.7 |
|       17500 |       3694 |                               0.7 |
|       30647 |       5099 |                               0.9 |
|         123 |       6006 |                               1.1 |
|          68 |       8525 |                               1.5 |
|          80 |      13618 |                               2.5 |
|           0 |      15732 |                               2.8 |
|        1900 |      22083 |                               4.0 |
|        5060 |      41721 |                               7.5 |
|         443 |      53135 |                               9.6 |
|          53 |      54893 |                               9.9 |

55.8%





select DISTINCT L7_PROTO,
count(idx),
round((count(idx)/554392)*100, 1)
from flowsv4
group by L7_PROTO
order by count(idx) asc;

|      145 |        296 |                               0.1 |
|      147 |        336 |                               0.1 |
|      201 |        358 |                               0.1 |
|       68 |        359 |                               0.1 |
|      133 |        389 |                               0.1 |
|      219 |        439 |                               0.1 |
|      143 |        455 |                               0.1 |
|      211 |        504 |                               0.1 |
|       37 |        513 |                               0.1 |
|       74 |        618 |                               0.1 |
|      122 |        624 |                               0.1 |
|      153 |        695 |                               0.1 |12
|      220 |        908 |                               0.2 |
|      140 |       1223 |                               0.2 |2
|       70 |       1459 |                               0.3 |
|      125 |       1486 |                               0.3 |
|       87 |       1494 |                               0.3 |
|      156 |       1561 |                               0.3 |
|      188 |       1835 |                               0.3 |
|      202 |       1846 |                               0.3 |6
|      212 |       2019 |                               0.4 |
|        8 |       2428 |                               0.4 |2
|      120 |       2740 |                               0.5 |1
|      121 |       4465 |                               0.8 |1
|       81 |       5023 |                               0.9 |1
|      124 |       5405 |                               1.0 |1
|       10 |       5996 |                               1.1 |1
|      214 |       7424 |                               1.3 |1
|        9 |       8608 |                               1.6 |
|       18 |       8965 |                               1.6 |2
|       14 |      10183 |                               1.8 |1
|       82 |      10620 |                               1.9 |1
|      154 |      17079 |                               3.1 |1


|        7 |      20450 |                               3.7 |1
|       91 |      28500 |                               5.1 |1
|      119 |      29106 |                               5.3 |1
|      178 |      39234 |                               7.1 |1
|      100 |      43103 |                               7.8 |1
|      126 |      48455 |                               8.7 |1
|       12 |      51883 |                               9.4 |1
|        5 |      86567 |                              15.6 |1
|        0 |      95943 |                              17.3 |1

80.8%

99.8%